<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Star | Portal</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="bg-animation"></div>
    <div class="overlay"></div>
    
    <nav>
        <div class="user-box" id="userInfo">
            <img src="" id="userAvatar" style="display:none; border-radius: 50%; width: 35px; margin-left: 10px;">
            <span id="userName">ุฌุงุฑู ุงูุชุญูู..</span>
        </div>
        <div class="nav-links">
            <a onclick="show('about')">ูู ูุญู</a>
            <a onclick="show('rules')">ุงูููุงููู</a>
            <a onclick="show('streamers')">ุงูุณุชุฑููุฑุฒ</a>
            <a onclick="show('apply')" class="apply-nav">ุงูุชูุฏูู</a>
        </div>
    </nav>

    <div id="about" class="container active">
        <div class="card">
            <h2 class="section-title"><i class="fas fa-star"></i> ูู ูุญู</h2>
            <p>ูุญู ูุฏููุฉ <b>ููุฑูุฏ ุณุชุงุฑ (World Star)</b>
ููุฑูุฏ ุณุชูุงุฑ โ ุฃูุซุฑ ูู ูุฌุฑุฏ ุณูุฑูุฑ 
```
ููู ููุฑููุฏ ุณุชูุงุฑุ ูู ุชููู ูุฌุฑุฏ ูุงุนุจ ููุฑ ูุฑูุฑ ุงููุฑุงู ุ ุจู ุฌุฒุก ูู ุนุงูู ูุงุจุถ ุจุงูุญูุงุฉ ุ ุญูุซ ููู ุดุฎุต ุฏูุฑุ ูููู ูุญุธุฉ ูููุฉ . ููุงุ ุชุตูุน ุงูุฐูุฑูุงุช ุ ุชุฎูุถ ุงูุชุญุฏูุงุช ุ ูุชุนูุด ุชุฌุฑุจุฉ ูุง ุชุดุจู ุฃู ุชุฌุฑุจุฉ ุฃุฎุฑู.

ููุฐ ุชุฃุณูุณูุง ููุณูุฑูุฑ ูู 22 ุฏูุณูุจุฑ 2021 ุ ูู ููู ูุฏููุง ูุฌุฑุฏ ุจูุงุก ุณูุฑูุฑ ุ ุจู ุจูุงุก ูุฌุชูุนุ ุจูุช ุ ููุทู ูุฌุฏ ููู ูู ูุงุนุจ ููุงูู ุ ุดุบูู ุ ูุญูุงุณู ุงูุฐู ูุง ููุชูู . ูู ูุฐุง ูุชุญูู ุจูุถู ุทุงูู ุฅุฏุงุฑู ูุญุชุฑู ูุนูู ุจูู ุฌูุฏ ูุถูุงู ุชุฌุฑุจุฉ ุงุณุชุซูุงุฆูุฉ ุ ุจุชูุฏูู ุงูุฏุนู ุงููุณุชูุฑ ุ ูุงูุงุณุชูุงุน ููุงุนุจูู ุ ูุฎูู ุจูุฆุฉ ุนุงุฏูุฉ ุชููุคูุง ุงูููุงูุณุฉ ูุงููุชุนุฉ .

ููุง ูุง ุญุฏูุฏ ููุทููุญ ุ ูุง ูููุฏ ููุฅุจุฏุงุน โฆ ูู ููุฑูุฏ ุณุชุงุฑ ุ ุฃูุช ุชุตูุน ูุตุชู ุ ูุชุญุฏุฏ ูุณุชูุจูู ุจููุณู !</p>
        </div>
    </div>

    <div id="rules" class="container">
        <div class="card">
            <h2 class="section-title" style="color:#ffcc00;"><i class="fas fa-scroll"></i> ููุงููู ุตูุงุน ุงููุญุชูู</h2>
            <ul class="rules-list">
                <li><i class="fas fa-check-circle"></i> ุงูุงูุชุฒุงู ุจููุงููู ุงูุณูุฑูุฑ ุจุดูู ุฌุฏู.</li>
                <li><i class="fas fa-check-circle"></i> ุนุฏู ุงูุฎุฑูุฌ ุนู ุงูุฑูู ุจูุงู ูููุง ูุงู ุงูุณุจุจ.</li>
                <li><i class="fas fa-check-circle"></i> ุชููุต ุงูุดุฎุตูุฉ ุจูู ุญุฐุงููุฑูุง (ูููุน ุงูุชูููุญ).</li>
                <li><i class="fas fa-check-circle"></i> ูููุน ุจุซ ุณูุฑูุฑุงุช ุฃุฎุฑู ูู ุฑูู ุงูุจุซูุซ.</li>
                <li><i class="fas fa-check-circle"></i> ูููุน ุฐูุฑ ุณูุจูุงุช ุงูุณูุฑูุฑ ุฃู ุงูููุชุดุงุช ุจุงูุจุซ.</li>
            </ul>
            <div class="warning-box">
                โ๏ธ ุงูุจุซ ูู ุณูุฑูุฑุงุช ุบูุฑ World Star ูุคุฏู ูุณุญุจ ุงูุฑุชุจุฉ ููุฑุงู.
            </div>
        </div>
    </div>

    <div id="streamers" class="container">
        <div class="card">
            <h2 class="section-title"><i class="fas fa-video"></i> ุงูุณุชุฑููุฑุฒ ุงููุนุชูุฏูู</h2>
            <div class="streamer-tag">Matrix~KWT</div>
        </div>
    </div>

    <div id="apply" class="container">
        <div class="card" id="applyContent">
            </div>
    </div>

    <script>
        function show(id) {
            document.querySelectorAll('.container').forEach(c => c.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        async function init() {
            try {
                const res = await fetch('/api/user');
                const data = await res.json();
                const content = document.getElementById('applyContent');

                if (!data.user) {
                    document.getElementById('userName').innerText = "ุฒุงุฆุฑ";
                    content.innerHTML = `
                        <div class="login-prompt">
                            <i class="fab fa-discord" style="font-size: 50px; color: #5865F2;"></i>
                            <h2>ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู ูููุชุงุจุนุฉ ๐</h2>
                            <p>ูุฑุฌู ุชุณุฌูู ุงูุฏุฎูู ุนุจุฑ ุฏูุณููุฑุฏ ูุชุชููู ูู ุฅุฑุณุงู ุทูุจ ุงูุชูุฏูู.</p>
                            <button onclick="location.href='/auth/discord'" class="btn-discord">
                                ุชุณุฌูู ุงูุฏุฎูู ุนุจุฑ Discord
                            </button>
                        </div>`;
                    return;
                }

                document.getElementById('userName').innerText = data.user.username;
                const av = document.getElementById('userAvatar');
                av.src = `https://cdn.discordapp.com/avatars/${data.user.id}/${data.user.avatar}.png`;
                av.style.display = "inline-block";

                if (!data.isOpen) {
                    content.innerHTML = `<div class="status-msg"><h2>ุนุฐุฑุงูุ ุงูุชูุฏูู ูุบูู ุญุงููุงู โ</h2></div>`;
                } else {
                    content.innerHTML = `
                        <h2 class="form-title"><i class="fas fa-edit"></i> ุชูุฏูู ุตูุงุนุฉ ุงููุญุชูู</h2>
                        <form id="applyForm" class="modern-form">
                            <div class="input-row">
                                <div class="input-group">
                                    <label>ุงูุงุณู ุงููุงูู</label>
                                    <input type="text" name="fullName" placeholder="ุงูุงุณู ููุง ูู ุงููููุฉ" required>
                                </div>
                                <div class="input-group">
                                    <label>ุงูุนูุฑ</label>
                                    <input type="number" name="age" placeholder="ูุซุงู: 21" required>
                                </div>
                            </div>

                            <div class="input-row">
                                <div class="input-group">
                                    <label>ุงุณู ุงูููุงุฉ ูุฑุงุจุทูุง</label>
                                    <input type="text" name="channelLink" placeholder="YouTube / Twitch / TikTok" required>
                                </div>
                                <div class="input-group">
                                    <label>ุนุฏุฏ ุงููุดุชุฑููู + ุงููุดุงูุฏุงุช</label>
                                    <input type="text" name="stats" placeholder="ูุซุงู: 10K / 500 ูุดุงูุฏ" required>
                                </div>
                            </div>

                            <div class="input-group">
                                <label>ููุน ุงููุญุชูู</label>
                                <select name="contentType" required>
                                    <option value="" disabled selected>ุงุฎุชุฑ ููุน ุงููุญุชูู</option>
                                    <option value="Streamer (ุจุซ ูุจุงุดุฑ)">Streamer (ุจุซ ูุจุงุดุฑ)</option>
                                    <option value="YouTuber (ููุงุทุน)">YouTuber (ููุงุทุน)</option>
                                    <option value="Designer (ูุตูู)">Designer (ูุตูู)</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label>ุนุฑู ุนู ููุณู ูุตุงูุน ูุญุชูู</label>
                                <textarea name="about" placeholder="ุชููู ุนู ุฎุจุฑุชู ููุณูุฑุชู..." required></textarea>
                            </div>

                            <div class="input-group">
                                <label>ูุงุฐุง ุชุญุชุงุฌ ูู ุงูุฅุฏุงุฑุฉ ููุณุงุนุฏุชูุ</label>
                                <textarea name="needs" placeholder="ุฃุฏูุงุชุ ุฏุนูุ ุฑุชุจุ ุฅูุฎ..."></textarea>
                            </div>

                            <div class="input-group">
                                <label>ูุงูู ุฃูุฏุงูู ูุน ููุฑูุฏ ุณุชุงุฑุ</label>
                                <textarea name="goals" placeholder="ููู ุณุชููุฏ ุงููุฏููุฉุ" required></textarea>
                            </div>

                            <button type="submit" class="btn-submit">ุฅุฑุณุงู ุงูุชูุฏูู</button>
                        </form>`;
                    
                    document.getElementById('applyForm').onsubmit = async (e) => {
                        e.preventDefault();
                        const f = e.target;
                        const formData = {
                            fullName: f.fullName.value,
                            age: f.age.value,
                            channelLink: f.channelLink.value,
                            stats: f.stats.value,
                            contentType: f.contentType.value,
                            about: f.about.value,
                            needs: f.needs.value,
                            goals: f.goals.value
                        };

                        const res = await fetch('/api/submit', {
                            method: 'POST',
                            headers: {'Content-Type': 'application/json'},
                            body: JSON.stringify(formData)
                        });

                        if (res.ok) { 
                            alert("โ ุชู ุฅุฑุณุงู ุทูุจู ุจูุฌุงุญ! ุณูุชู ุงูุฑุฏ ุนููู ูู ุงูุฏูุณููุฑุฏ."); 
                            location.reload(); 
                        } else {
                            const err = await res.json();
                            alert("โ ุฎุทุฃ: " + err.error);
                        }
                    };
                }
            } catch (e) { console.log(e); }
        }
        window.onload = init;
    </script>
</body>
</html>